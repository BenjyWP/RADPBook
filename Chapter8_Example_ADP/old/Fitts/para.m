%para.m

tau=0.05;
m1=2;
m2=2;
kai=.7;
d11=13*kai;
d12=-18*kai;
d21=18*kai;
d22=13*kai;

c1=.15/2;
c2=.05/2;
dt=0.005;

in=0;

A0=[0 0 1        0      0      0;
   0 0 0        1      0      0;
   0 0 0        0     1/m1    0;
   0 0 0        0      0      1/m2;
   0 0 0        0      -1/tau 0;
   0 0 0        0      0      -1/tau];


%% simulating the velocity force field
A=A0+[0 0 0     0      0 0;
      0 0 0     0      0 0;
      0 0 d11/m1 d12/m1      0 0;
      0 0 d21/m2 d22/m2      0 0;
      0 0 0     0      0 0;
      0 0 0     0      0 0];


% A=A0+[0 0 0     0      0 0;
%       0 0 0     0      0 0;
%       150/m1    0 0     0      0 0;
%       0 0 0     0      0 0;
%       0 0 0     0      0 0;
%       0 0 0     0      0 0];

B=[0 0;
   0 0;
   0 0;
   0 0;
   1/tau 0;
   0 1/tau];

%%

Q=10*diag([50,100,2, 2,0.001,0.001]); 

Q1=10*diag([200,100,2,2,0.001,0.001]);

R=[.01 0; 0 .01];% worked



Q(1,2)=-10*10;
Q(2,1)=Q(1,2);
Q(3,4)=-1;%8;
Q(4,3)=Q(3,4);
%Q1=Q;

%R(1,2)=0;
%R(2,1)=R(1,2);
%Q1=100*diag([100,100,10,10,0,0]);R=diag([.1,.1]);
%Q1=100*diag([100,100,10,10,0,0]);R=diag([.1,.1]);


%Q1(1,1)=600*10;
Q1(1,2)=-400;
Q1(2,1)=Q1(1,2);
Q1(3,4)=-1;
Q1(4,3)=Q1(3,4);

% Q=Q./10;
%R=R./10;

%K0=[1000 0 250 0 10 0;0 1000 0 250 0 10];
%K0(1:2,1:2)=K0(1:2,1:2)*1.1;
K=lqr(A0,B,Q,R);
K0=K*3;
%K0(1:2,1:2)=K(1:2,1:2)*3;
%K0(1:2,1:2)=K(1:2,1:2)*2;
Ko=lqr(A,B,Q1,R);
% K0=K;
% K0(1,1)=K(1,1)+500;%230;
% K0(2,2)=K(2,2)+0;


%K=K1
% eig(A-B*K);

